@using Microsoft.AspNetCore.Identity
@using HealthApp.MVC.Models.Entities
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
    Layout = null;
    string firstName = "";
    string lastName = "";
    if (SignInManager.IsSignedIn(User))
    {
        var currentUser = await UserManager.GetUserAsync(User);
        firstName = currentUser?.FirstName ?? "";
        lastName = currentUser?.LastName ?? "";
    }

    var title = "Hospital Plus";
    if (ViewData["Title"] != null)
    {
        title += " - " + ViewData["Title"];
    }
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@title</title>
    <link rel="stylesheet" href="~/css/style.css" />
    <link rel="stylesheet" href="~/css/uicons-solid-rounded.css" />
    <link rel="icon" type="image/x-icon" href="/images/logo.ico" />
    @RenderSection("Styles", required: false)

</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar (Left Navigation) -->
        <aside class="dashboard-sidebar">
            <div class="sidebar-brand">
                <h2>@lastName @firstName</h2>
            </div>
            <nav class="sidebar-menu">
                <ul>
                    <li>
                        <a asp-area="" asp-controller="Home" asp-action="Index">
                            <i class="fi fi-sr-home"></i>
                            <span>Home</span>
                        </a>
                    </li>
                    <li>
                        <a asp-area="Patients" asp-controller="Patient" asp-action="Index" class="@(ViewContext.RouteData.Values["controller"].ToString() == "Patient" && ViewContext.RouteData.Values["action"].ToString() == "Index" ? "active" : "")">
                            <i class="fi fi-sr-dashboard-panel"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a asp-area="Patients" asp-controller="Appointments" asp-action="Index" class="@(ViewContext.RouteData.Values["controller"].ToString() == "Appointments" ? "active" : "")">
                            <i class="fi fi-sr-calendar-lines"></i>
                            <span>Appointments</span>
                        </a>
                    </li>
                    <li>
                        <a asp-area="Patients" asp-controller="Messaging" asp-action="Index">
                            <i class="fi fi-sr-bell-notification-social-media"></i>
                            <span>Notifications</span>
                        </a>
                    </li>
                    <li>
                        <a asp-area="Patients" asp-controller="Profile" asp-action="Index">
                            <i class="fi fi-sr-user"></i>
                            <span>Profile</span>
                        </a>
                    </li>
                    <li>
                        <form class="form-inline" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                            <button type="submit" class="">
                                <i class="fi fi-sr-leave"></i>
                                <span>Log out</span>
                            </button>
                        </form>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Dashboard Wrapper -->
        <div class="dashboard-wrapper">
            <!-- Main Content & Summary -->
            <div class="dashboard-content">
                <!-- Main content area (left) -->
                <main class="main-content">
                    @RenderBody()
                </main>

                @if (IsSectionDefined("TimetableException"))
                {
                    @RenderSection("TimetableException", required: false)
                }
            </div>
        </div>
    </div>

    @RenderSection("Scripts", required: false)
</body>
</html>